---

title: Running PyTest in Jupyter Notebooks


keywords: fastai
sidebar: home_sidebar

summary: "iPyMock uses GPT 3.5 turbo by browser automation and <a href='https://huggingface.co/GanymedeNil/text2vec-large-chinese'>a CoSENT based model</a> to embed English and Chinese."
description: "iPyMock uses GPT 3.5 turbo by browser automation and <a href='https://huggingface.co/GanymedeNil/text2vec-large-chinese'>a CoSENT based model</a> to embed English and Chinese."
nb_path: "nbs/0_index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/0_index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://discord.gg/ARTMvTQv"><img src="https://dcbadge.vercel.app/api/server/ARTMvTQv?style=flat" alt="Discord Follow"></a>
<a href="https://twitter.com/seii_saintway"><img src="https://img.shields.io/twitter/follow/seii_saintway?style=social" alt="Twitter Follow"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-iPyMock">Setup iPyMock<a class="anchor-link" href="#Setup-iPyMock"> </a></h2><p>Get your access_token at <a href="https://chat.openai.com/api/auth/session">openai api session</a> and the conversation_id in the url of chat.openai.com/c/\&lt;conversation_id&gt;</p>
<div class="highlight"><pre><span></span>mkdir -p ~/.config/ipymock

cat <span class="s">&lt;&lt; EOF &gt; ~/.config/ipymock/config.json</span>
<span class="s">{</span>
<span class="s">  &quot;access_token&quot;: &quot;&lt;access_token&gt;&quot;,</span>
<span class="s">  &quot;conversation_id&quot;: &quot;&lt;conversation_id&gt;&quot;</span>
<span class="s">}</span>
<span class="s">EOF</span>

pip install --upgrade ipymock
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-the-Browser-Side-API-in-Jupyter-Notebooks">Using the Browser Side API in Jupyter Notebooks<a class="anchor-link" href="#Using-the-Browser-Side-API-in-Jupyter-Notebooks"> </a></h2><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipymock.browser</span> <span class="kn">import</span> <span class="n">start_conversation</span>
<span class="kn">import</span> <span class="nn">IPython</span>

<span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">start_conversation</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">IPython</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Markdown</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">ipymock.browser</span>
<span class="c1"># if the proxy is deployed locally</span>
<span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">chat_gpt_base_url</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span>
<span class="c1"># otherwise using a third party proxy</span>
<span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">chat_gpt_base_url</span> <span class="o">=</span> <span class="s1">&#39;https://.../api&#39;</span>
<span class="c1"># the conversation_id which is set in config.json</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">conversation_id</span><span class="p">)</span>

<span class="n">ask</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">what is the meaning of getting patched?</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-AutoGPT">Testing AutoGPT<a class="anchor-link" href="#Testing-AutoGPT"> </a></h2><p>This is the test function for AutoGPT.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/Auto-GPT&#39;</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/Auto-GPT&#39;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">test_auto_gpt</span><span class="p">(</span>
    <span class="n">mock_openai</span><span class="p">,</span>
    <span class="n">mock_openai_embed</span><span class="p">,</span>
    <span class="n">reset_embed_dimension</span><span class="p">,</span>
<span class="p">):</span>
    <span class="kn">from</span> <span class="nn">autogpt.main</span> <span class="kn">import</span> <span class="n">run_auto_gpt</span>
    <span class="n">run_auto_gpt</span><span class="p">(</span>
        <span class="n">continuous</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">continuous_limit</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="n">ai_settings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip_reprompt</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">speak</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">gpt3only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">gpt4only</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">memory_type</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span>
        <span class="n">browser_name</span> <span class="o">=</span> <span class="s1">&#39;safari&#39;</span><span class="p">,</span>
        <span class="n">allow_downloads</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">skip_news</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">workspace_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/Auto-GPT/andrew_space&#39;</span><span class="p">),</span>
        <span class="n">install_plugin_deps</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="kc">True</span>
</pre></div>
<p>It actually run AutoGPT by pytest mock and browser automation.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipymock</span>
<span class="kn">import</span> <span class="nn">ipymock.browser</span>
<span class="kn">import</span> <span class="nn">ipymock.llm</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">chat_gpt_base_url</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span>
<span class="c1"># reset conversation_id to empty to start a new chat</span>
<span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">conversation_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">reset_embed_dimension</span><span class="p">(</span><span class="n">monkeypatch</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">autogpt.memory.local</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">autogpt</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">local</span><span class="p">,</span> <span class="s1">&#39;EMBED_DIM&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>

<span class="n">ipymock</span><span class="o">.</span><span class="n">do</span><span class="p">(</span>
    <span class="n">mock_openai</span> <span class="o">=</span> <span class="n">ipymock</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">mock_openai</span><span class="p">,</span>
    <span class="n">mock_openai_embed</span> <span class="o">=</span> <span class="n">ipymock</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">mock_openai_embed</span><span class="p">,</span>
    <span class="n">reset_embed_dimension</span> <span class="o">=</span> <span class="n">reset_embed_dimension</span><span class="p">,</span>
    <span class="n">test_auto_gpt</span> <span class="o">=</span> <span class="n">test_auto_gpt</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This project is still under development and lack of documentation.</p>
<p>This is <a href="https://seii-saintway.github.io/2023/04/06/Autonomous-Agents/">an article</a> I wrote that mock openai to test autonomous robots.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Mechanism-of-PyTesting-the-Python-Testfiles">The Mechanism of PyTesting the Python Testfiles<a class="anchor-link" href="#The-Mechanism-of-PyTesting-the-Python-Testfiles"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pluggy</span>
<span class="n">pm</span> <span class="o">=</span> <span class="n">pluggy</span><span class="o">.</span><span class="n">PluginManager</span><span class="p">(</span><span class="s1">'pytest'</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">_pytest.hookspec</span>
<span class="n">pm</span><span class="o">.</span><span class="n">add_hookspecs</span><span class="p">(</span><span class="n">_pytest</span><span class="o">.</span><span class="n">hookspec</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">_pytest.main</span>
<span class="n">pm</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">_pytest</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="s1">'main'</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">_pytest.config</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[])</span>
<span class="n">pm</span><span class="o">.</span><span class="n">hook</span><span class="o">.</span><span class="n">pytest_cmdline_main</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">_pytest.config</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[])</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pluginmanager</span><span class="o">.</span><span class="n">hook</span><span class="o">.</span><span class="n">pytest_cmdline_main</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PyTesting-the-Python-Testcases-within-iPyNb-Runtimes">PyTesting the Python Testcases within iPyNb Runtimes<a class="anchor-link" href="#PyTesting-the-Python-Testcases-within-iPyNb-Runtimes"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>


<span class="n">testdata</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
    <span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">timedelta</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">idfn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="p">,)):</span>
        <span class="c1"># note this wouldn't show any hours/minutes/seconds</span>
        <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y%m</span><span class="si">%d</span><span class="s1">'</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s1">'a,b,expected'</span><span class="p">,</span> <span class="n">testdata</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_timedistance_v0</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">==</span> <span class="n">expected</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s1">'a,b,expected'</span><span class="p">,</span> <span class="n">testdata</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="s1">'forward'</span><span class="p">,</span> <span class="s1">'backward'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_timedistance_v1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">==</span> <span class="n">expected</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s1">'a,b,expected'</span><span class="p">,</span> <span class="n">testdata</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="n">idfn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_timedistance_v2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">==</span> <span class="n">expected</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s1">'a,b,expected'</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
            <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">id</span><span class="o">=</span><span class="s1">'forward'</span>
        <span class="p">),</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
            <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">timedelta</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">id</span><span class="o">=</span><span class="s1">'backward'</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_timedistance_v3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">!=</span> <span class="n">expected</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">_pytest.config</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[])</span>

<span class="kn">import</span> <span class="nn">_pytest.main</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">_pytest.runner</span>
<span class="n">ss</span><span class="o">.</span><span class="n">_setupstate</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">SetupState</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">_pytest.fixtures</span>
<span class="n">ss</span><span class="o">.</span><span class="n">_fixturemanager</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">fixtures</span><span class="o">.</span><span class="n">FixtureManager</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">_pytest.python</span>
<span class="kn">import</span> <span class="nn">py</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">_pytest</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">Module</span><span class="o">.</span><span class="n">from_parent</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">fspath</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">local</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Object</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">entries</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">Object</span><span class="p">(</span><span class="o">**</span><span class="nb">globals</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">_pytest.runner</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">collect</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'idx = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_pytest</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">call_and_report</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">'setup'</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_pytest</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">call_and_report</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">'call'</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_pytest</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">call_and_report</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">'teardown'</span><span class="p">,</span> <span class="n">nextitem</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>idx = 0
&lt;TestReport &#39;::unittests::test_timedistance_v0[a0-b0-expected0]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v0[a0-b0-expected0]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v0[a0-b0-expected0]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 1
&lt;TestReport &#39;::unittests::test_timedistance_v0[a1-b1-expected1]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v0[a1-b1-expected1]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v0[a1-b1-expected1]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 2
&lt;TestReport &#39;::unittests::test_timedistance_v1[forward]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v1[forward]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v1[forward]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 3
&lt;TestReport &#39;::unittests::test_timedistance_v1[backward]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v1[backward]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v1[backward]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 4
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011212-20011211-expected0]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011212-20011211-expected0]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011212-20011211-expected0]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 5
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011211-20011212-expected1]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011211-20011212-expected1]&#39; when=&#39;call&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v2[20011211-20011212-expected1]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 6
&lt;TestReport &#39;::unittests::test_timedistance_v3[forward]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v3[forward]&#39; when=&#39;call&#39; outcome=&#39;failed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v3[forward]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
idx = 7
&lt;TestReport &#39;::unittests::test_timedistance_v3[backward]&#39; when=&#39;setup&#39; outcome=&#39;passed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v3[backward]&#39; when=&#39;call&#39; outcome=&#39;failed&#39;&gt;
&lt;TestReport &#39;::unittests::test_timedistance_v3[backward]&#39; when=&#39;teardown&#39; outcome=&#39;passed&#39;&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">collect</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;idx = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">runtest</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-to-Use-the-Do-PyTest?">How to Use the Do-PyTest?<a class="anchor-link" href="#How-to-Use-the-Do-PyTest?"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">my_fixture_1</span><span class="p">(</span><span class="n">tmpdir_factory</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tmpdir_factory</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">my_fixture_2</span><span class="p">(</span><span class="n">tmpdir_factory</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tmpdir_factory</span>

<span class="k">def</span> <span class="nf">test_fixture</span><span class="p">(</span><span class="n">my_fixture_1</span><span class="p">,</span> <span class="n">my_fixture_2</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">my_fixture_1</span> <span class="o">==</span> <span class="n">my_fixture_2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ipymock</span> <span class="kn">import</span> <span class="n">do</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do</span><span class="p">(</span>
    <span class="n">my_fixture_1</span><span class="o">=</span><span class="n">my_fixture_1</span><span class="p">,</span>
    <span class="n">my_fixture_2</span><span class="o">=</span><span class="n">my_fixture_2</span><span class="p">,</span>
    <span class="n">test_fixture</span><span class="o">=</span><span class="n">test_fixture</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
=&gt; no.0  nbs::test_fixture  setup  passed

=&gt; no.0  nbs::test_fixture  runtest  passed

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Troubleshooting-Tips-of-NbDev">Troubleshooting Tips of NbDev<a class="anchor-link" href="#Troubleshooting-Tips-of-NbDev"> </a></h2><ul>
<li>Make sure you are using the latest version of nbdev with <code>pip install -U nbdev</code></li>
<li>If you are using an older version of this template, see the instructions above on how to upgrade your template. </li>
<li>It is important for you to spell the name of your user and repo correctly in <code>settings.ini</code> or the website will not have the correct address from which to source assets like CSS for your site.  When in doubt, you can open your browser's developer console and see if there are any errors related to fetching assets for your website due to an incorrect URL generated by misspelled values from <code>settings.ini</code>.</li>
<li>If you change the name of your repo, you have to make the appropriate changes in <code>settings.ini</code></li>
<li>After you make changes to <code>settings.ini</code>, run <code>nbdev_build_lib &amp;&amp; nbdev_clean_nbs &amp;&amp; nbdev_build_docs</code> to make sure all changes are propagated appropriately.</li>
</ul>

</div>
</div>
</div>
</div>


